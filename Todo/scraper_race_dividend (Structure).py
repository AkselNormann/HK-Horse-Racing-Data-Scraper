#import libraries
from bs4 import BeautifulSoup
import requests
import string
from selenium import webdriver
from selenium.common.exceptions import NoSuchElementException
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from selenium.common.exceptions import WebDriverException
import pandas as pd
import os.path

#starting webdriver
BASE_URL = "https://racing.hkjc.com/racing/information/Chinese/racing/LocalResults.aspx?RaceDate="
dates = ["1970-01-01",


"2000-06-25",
"2000-06-21",
"2000-06-17",
"2000-06-14",
"2000-06-10",
"2000-06-07",
"2000-06-04",
"2000-05-31",
"2000-05-27",
"2000-05-21",
"2000-05-17",
"2000-05-13",
"2000-05-10",
"2000-05-07",
"2000-05-03",
"2000-04-29",
"2000-04-26",
"2000-04-22",
"2000-04-16",
"2000-04-12",
"2000-04-08",
"2000-04-05",
"2000-04-01",
"2000-03-29",
"2000-03-26",
"2000-03-22",
"2000-03-18",
"2000-03-15",
"2000-03-11",
"2000-03-08",
"2000-03-05",
"2000-03-01",
"2000-02-26",
"2000-02-23",
"2000-02-20",
"2000-02-16",
"2000-02-12",
"2000-02-07",
"2000-02-02",
"2000-01-29",
"2000-01-26",
"2000-01-23",
"2000-01-19",
"2000-01-15",
"2000-01-12",
"2000-01-08",
"2000-01-05",
"2000-01-02",
"1999-12-31",
"1999-12-26",
"1999-12-18",
"1999-12-12",
"1999-12-08",
"1999-12-04",
"1999-12-01",
"1999-11-27",
"1999-11-24",
"1999-11-21",
"1999-11-17",
"1999-11-13",
"1999-11-10",
"1999-11-06",
"1999-11-02",
"1999-10-30",
"1999-10-23",
"1999-10-20",
"1999-10-16",
"1999-10-13",
"1999-10-09",
"1999-10-06",
"1999-10-03",
"1999-10-01",
"1999-09-22",
"1999-09-18",
"1999-09-15",
"1999-09-11",
"1999-09-08",
"1999-09-05",
"1999-06-13",
"1999-06-09",
"1999-06-05",
"1999-06-02",
"1999-05-29",
"1999-05-26",
"1999-05-23",
"1999-05-19",
"1999-05-15",
"1999-05-12",
"1999-05-08",
"1999-05-05",
"1999-04-28",
"1999-04-24",
"1999-04-21",
"1999-04-18",
"1999-04-14",
"1999-04-10",
"1999-04-07",
"1999-04-03",
"1999-03-31",
"1999-03-27",
"1999-03-24",
"1999-03-21",
"1999-03-17",
"1999-03-13",
"1999-03-10",
"1999-03-07",
"1999-03-03",
"1999-02-27",
"1999-02-24",
"1999-02-21",
"1999-02-18",
"1999-02-10",
"1999-02-06",
"1999-02-03",
"1999-01-30",
"1999-01-27",
"1999-01-23",
"1999-01-20",
"1999-01-17",
"1999-01-13",
"1999-01-09",
"1999-01-06",
"1999-01-01",
"1998-12-19",
"1998-12-16",
"1998-12-13",
"1998-12-09",
"1998-12-05",
"1998-12-02",
"1998-11-29",
"1998-11-25",
"1998-11-21",
"1998-11-18",
"1998-11-14",
"1998-11-11",
"1998-11-08",
"1998-11-03",
"1998-10-31",
"1998-10-24",
"1998-10-21",
"1998-10-17",
"1998-10-14",
"1998-10-10",
"1998-10-07",
"1998-10-04",
"1998-10-01",
"1998-09-26",
"1998-09-23",
"1998-09-19",
"1998-09-16",
"1998-09-12",
"1998-09-09",
"1998-09-06",
"1998-06-14",
"1998-06-10",
"1998-06-06",
"1998-06-03",
"1998-05-30",
"1998-05-27",
"1998-05-23",
"1998-05-20",
"1998-05-16",
"1998-05-13",
"1998-05-09",
"1998-05-06",
"1998-05-03",
"1998-04-29",
"1998-04-25",
"1998-04-22",
"1998-04-19",
"1998-04-15",
"1998-04-11",
"1998-04-08",
"1998-04-04",
"1998-04-01",
"1998-03-28",
"1998-03-21",
"1998-03-18",
"1998-03-15",
"1998-03-11",
"1998-03-07",
"1998-03-04",
"1998-03-01",
"1998-02-25",
"1998-02-21",
"1998-02-18",
"1998-02-14",
"1998-02-11",
"1998-02-07",
"1998-02-04",
"1998-02-01",
"1998-01-30",
"1998-01-21",
"1998-01-18",
"1998-01-14",
"1998-01-10",
"1998-01-07",
"1998-01-04",
"1998-01-01",
"1997-12-20",
"1997-12-17",
"1997-12-14",
"1997-12-10",
"1997-12-06",
"1997-12-03",
"1997-11-30",
"1997-11-26",
"1997-11-23",
"1997-11-19",
"1997-11-15",
"1997-11-12",
"1997-11-08",
"1997-11-04",
"1997-11-01",
"1997-10-26",
"1997-10-22",
"1997-10-18",
"1997-10-15",
"1997-10-11",
"1997-10-08",
"1997-10-05",
"1997-10-02",
"1997-09-27",
"1997-09-24",
"1997-09-20",
"1997-09-17",
"1997-09-13",
"1997-09-06",
"1997-06-15",
"1997-06-11",
"1997-06-07",
"1997-06-04",
"1997-05-31",
"1997-05-28",
"1997-05-24",
"1997-05-21",
"1997-05-18",
"1997-05-14",
"1997-05-10",
"1997-05-07",
"1997-05-03",
"1997-04-30",
"1997-04-27",
"1997-04-23",
"1997-04-19",
"1997-04-16",
"1997-04-13",
"1997-04-09",
"1997-04-05",
"1997-03-31",
"1997-03-29",
"1997-03-26",
"1997-03-22",
"1997-03-16",
"1997-03-12",
"1997-03-08",
"1997-03-05",
"1997-03-01",
"1997-02-26",
"1997-02-23",
"1997-02-19",
"1997-02-15",
"1997-02-12",
"1997-02-09",
"1997-01-29",
"1997-01-25",
"1997-01-22",
"1997-01-18",
"1997-01-15",
"1997-01-12",
"1997-01-08",
"1997-01-04",
"1997-01-01",
"1996-12-29",
"1996-12-18",
"1996-12-14",
"1996-12-11",
"1996-12-08",
"1996-12-04",
"1996-11-30",
"1996-11-27",
"1996-11-24",
"1996-11-20",
"1996-11-16",
"1996-11-13",
"1996-11-09",
"1996-11-02",
"1996-10-30",
"1996-10-27",
"1996-10-23",
"1996-10-19",
"1996-10-16",
"1996-10-12",
"1996-10-09",
"1996-10-06",
"1996-10-02",
"1996-09-28",
"1996-09-25",
"1996-09-21",
"1996-09-18",
"1996-09-14",
"1996-09-11",
"1996-09-08",
"1996-06-09",
"1996-06-05",
"1996-06-01",
"1996-05-29",
"1996-05-25",
"1996-05-19",
"1996-05-15",
"1996-05-11",
"1996-05-08",
"1996-05-04",
"1996-05-01",
"1996-04-28",
"1996-04-24",
"1996-04-20",
"1996-04-17",
"1996-04-14",
"1996-04-10",
"1996-04-06",
"1996-04-03",
"1996-03-30",
"1996-03-23",
"1996-03-20",
"1996-03-16",
"1996-03-13",
"1996-03-10",
"1996-03-06",
"1996-03-02",
"1996-02-28",
"1996-02-25",
"1996-02-21",
"1996-02-11",
"1996-02-10",
"1996-02-07",
"1996-02-03",
"1996-01-31",
"1996-01-27",
"1996-01-24",
"1996-01-20",
"1996-01-17",
"1996-01-14",
"1996-01-10",
"1996-01-06",
"1996-01-01",
"1995-12-20",
"1995-12-16",
"1995-12-13",
"1995-12-10",
"1995-12-06",
"1995-12-02",
"1995-11-29",
"1995-11-25",
"1995-11-22",
"1995-11-18",
"1995-11-15",
"1995-11-11",
"1995-11-05",
"1995-10-28",
"1995-10-25",
"1995-10-21",
"1995-10-18",
"1995-10-14",
"1995-10-11",
"1995-10-07",
"1995-10-04",
"1995-10-01",
"1995-09-27",
"1995-09-23",
"1995-09-20",
"1995-09-16",
"1995-09-13",
"1995-09-10",
"1995-06-07",
"1995-06-03",
"1995-05-31",
"1995-05-27",
"1995-05-24",
"1995-05-20",
"1995-05-17",
"1995-05-13",
"1995-05-07",
"1995-05-03",
"1995-04-29",
"1995-04-26",
"1995-04-22",
"1995-04-19",
"1995-04-15",
"1995-04-12",
"1995-04-08",
"1995-04-01",
"1995-03-29",
"1995-03-25",
"1995-03-22",
"1995-03-19",
"1995-03-15",
"1995-03-11",
"1995-03-04",
"1995-02-26",
"1995-02-22",
"1995-02-18",
"1995-02-15",
"1995-02-11",
"1995-02-08",
"1995-02-05",
"1995-02-02",
"1995-01-21",
"1995-01-18",
"1995-01-15",
"1995-01-11",
"1995-01-07",
"1995-01-04",
"1995-01-01",
"1994-12-21",
"1994-12-17",
"1994-12-14",
"1994-12-11",
"1994-12-07",
"1994-12-03",
"1994-11-30",
"1994-11-27",
"1994-11-23",
"1994-11-19",
"1994-11-16",
"1994-11-12",
"1994-11-09",
"1994-11-05",
"1994-10-30",
"1994-10-26",
"1994-10-22",
"1994-10-19",
"1994-10-15",
"1994-10-12",
"1994-10-08",
"1994-10-05",
"1994-10-02",
"1994-09-28",
"1994-09-24",
"1994-09-17",
"1994-09-14",
"1994-09-11",
"1994-06-05",
"1994-06-01",
"1994-05-28",
"1994-05-25",
"1994-05-21",
"1994-05-18",
"1994-05-15",
"1994-05-07",
"1994-05-04",
"1994-04-30",
"1994-04-27",
"1994-04-23",
"1994-04-20",
"1994-04-16",
"1994-04-13",
"1994-04-09",
"1994-04-02",
"1994-03-30",
"1994-03-26",
"1994-03-23",
"1994-03-20",
"1994-03-16",
"1994-03-13",
"1994-03-09",
"1994-03-05",
"1994-02-27",
"1994-02-23",
"1994-02-19",
"1994-02-16",
"1994-02-12",
"1994-02-05",
"1994-02-02",
"1994-01-29",
"1994-01-26",
"1994-01-22",
"1994-01-19",
"1994-01-16",
"1994-01-12",
"1994-01-08",
"1994-01-05",
"1994-01-01",
"1993-12-29",
"1993-12-21",
"1993-12-18",
"1993-12-15",
"1993-12-12",
"1993-12-08",
"1993-12-04",
"1993-12-01",
"1993-11-28",
"1993-11-24",
"1993-11-20",
"1993-11-17",
"1993-11-13",
"1993-11-10",
"1993-11-06",
"1993-10-31",
"1993-10-27",
"1993-10-20",
"1993-10-16",
"1993-10-13",
"1993-10-09",
"1993-10-06",
"1993-10-03",
"1993-09-29",
"1993-09-22",
"1993-09-18",
"1993-09-15",
"1993-09-12",
"1993-06-13",
"1993-06-09",
"1993-06-05",
"1993-06-02",
"1993-05-29",
"1993-05-26",
"1993-05-22",
"1993-05-19",
"1993-05-16",
"1993-05-12",
"1993-05-08",
"1993-05-05",
"1993-05-01",
"1993-04-28",
"1993-04-24",
"1993-04-21",
"1993-04-18",
"1993-04-14",
"1993-04-12",
"1993-04-10",
"1993-04-07",
"1993-04-03",
"1993-03-31",
"1993-03-27",
"1993-03-24",
"1993-03-21",
"1993-03-17",
"1993-03-13",
"1993-03-10",
"1993-03-07",
"1993-03-03",
"1993-02-27",
"1993-02-24",
"1993-02-20",
"1993-02-17",
"1993-02-13",
"1993-02-10",
"1993-02-07",
"1993-02-03",
"1993-01-30",
"1993-01-27",
"1993-01-25",
"1993-01-20",
"1993-01-16",
"1993-01-13",
"1993-01-10",
"1993-01-06",
"1993-01-01",
"1992-12-23",
"1992-11-21",
"1992-11-18",
"1992-11-14",
"1992-11-11",
"1992-11-08",
"1992-10-31",
"1992-10-28",
"1992-10-24",
"1992-10-21",
"1992-10-17",
"1992-10-14",
"1992-10-11",
"1992-10-07",
"1992-10-03",
"1992-09-30",
"1992-09-27",
"1992-09-23",
"1992-09-19",
"1992-09-16",
"1992-09-13",
"1992-06-07",
"1992-06-03",
"1992-05-31",
"1992-05-27",
"1992-05-23",
"1992-05-17",
"1992-05-13",
"1992-05-09",
"1992-05-06",
"1992-05-02",
"1992-04-29",
"1992-04-25",
"1992-04-22",
"1992-04-18",
"1992-04-12",
"1992-04-08",
"1992-04-01",
"1992-03-28",
"1992-03-25",
"1992-03-21",
"1992-03-18",
"1992-03-15",
"1992-03-07",
"1992-03-04",
"1992-02-29",
"1992-02-26",
"1992-02-22",
"1992-02-19",
"1992-02-15",
"1992-02-12",
"1992-02-09",
"1992-02-06",
"1992-01-29",
"1992-01-25",
"1992-01-22",
"1992-01-18",
"1992-01-12",
"1992-01-08",
"1992-01-04",
"1992-01-01",
"1991-12-29",
"1991-12-21",
"1991-12-18",
"1991-12-15",
"1991-12-11",
"1991-12-07",
"1991-11-30",
"1991-11-27",
"1991-11-24",
"1991-11-20",
"1991-11-16",
"1991-11-13",
"1991-11-10",
"1991-11-02",
"1991-10-30",
"1991-10-26",
"1991-10-23",
"1991-10-19",
"1991-10-12",
"1991-10-09",
"1991-10-06",
"1991-10-02",
"1991-09-28",
"1991-09-25",
"1991-09-21",
"1991-09-18",
"1991-09-14",
"1991-06-09",
"1991-06-05",
"1991-06-01",
"1991-05-29",
"1991-05-26",
"1991-05-18",
"1991-05-15",
"1991-05-12",
"1991-05-08",
"1991-05-04",
"1991-04-27",
"1991-04-24",
"1991-04-21",
"1991-04-17",
"1991-04-13",
"1991-04-10",
"1991-04-06",
"1991-04-03",
"1991-03-30",
"1991-03-27",
"1991-03-23",
"1991-03-20",
"1991-03-16",
"1991-03-10",
"1991-03-06",
"1991-03-02",
"1991-02-27",
"1991-02-24",
"1991-02-20",
"1991-02-17",
"1991-02-09",
"1991-02-06",
"1991-02-02",
"1991-01-30",
"1991-01-27",
"1991-01-19",
"1991-01-16",
"1991-01-13",
"1991-01-09",
"1991-01-05",
"1991-01-01",
"1990-12-29",
"1990-12-19",
"1990-12-16",
"1990-12-12",
"1990-12-08",
"1990-12-05",
"1990-12-01",
"1990-11-28",
"1990-11-25",
"1990-11-21",
"1990-11-17",
"1990-11-10",
"1990-11-07",
"1990-11-03",
"1990-10-27",
"1990-10-24",
"1990-10-20",
"1990-10-17",
"1990-10-13",
"1990-10-10",
"1990-10-07",
"1990-09-29",
"1990-09-26",
"1990-09-22",
"1990-09-19",
"1990-09-15",
"1990-06-23",
"1990-06-16",
"1990-06-10",
"1990-06-06",
"1990-06-02",
"1990-05-27",
"1990-05-23",
"1990-05-19",
"1990-05-16",
"1990-05-13",
"1990-05-09",
"1990-05-05",
"1990-04-29",
"1990-04-25",
"1990-04-21",
"1990-04-16",
"1990-04-14",
"1990-04-11",
"1990-04-07",
"1990-03-31",
"1990-03-28",
"1990-03-25",
"1990-03-21",
"1990-03-17",
"1990-03-14",
"1990-03-11",
"1990-03-07",
"1990-03-03",
"1990-02-28",
"1990-02-25",
"1990-02-21",
"1990-02-17",
"1990-02-14",
"1990-02-10",
"1990-02-07",
"1990-02-03",
"1990-01-29",
"1990-01-20",
"1990-01-17",
"1990-01-13",
"1990-01-10",
"1990-01-07",
"1990-01-01",
"1989-12-23",
"1989-12-20",
"1989-12-17",
"1989-12-13",
"1989-12-10",
"1989-12-02",
"1989-11-29",
"1989-11-25",
"1989-11-22",
"1989-11-18",
"1989-11-11",
"1989-11-08",
"1989-11-04",
"1989-11-01",
"1989-10-29",
"1989-10-25",
"1989-10-21",
"1989-10-18",
"1989-10-14",
"1989-10-07",
"1989-10-04",
"1989-10-01",
"1989-09-27",
"1989-09-23",
"1989-09-20",
"1989-09-16",
"1989-05-28",
"1989-05-24",
"1989-05-17",
"1989-05-14",
"1989-05-06",
"1989-05-03",
"1989-04-30",
"1989-04-26",
"1989-04-22",
"1989-04-19",
"1989-04-15",
"1989-04-12",
"1989-04-08",
"1989-04-01",
"1989-03-27",
"1989-03-25",
"1989-03-22",
"1989-03-19",
"1989-03-15",
"1989-03-11",
"1989-03-08",
"1989-03-04",
"1989-03-01",
"1989-02-26",
"1989-02-22",
"1989-02-18",
"1989-02-15",
"1989-02-11",
"1989-02-08",
"1989-02-01",
"1989-01-29",
"1989-01-25",
"1989-01-21",
"1989-01-18",
"1989-01-15",
"1989-01-11",
"1989-01-07",
"1989-01-02",
"1988-12-28",
"1988-12-21",
"1988-12-17",
"1988-12-14",
"1988-12-11",
"1988-12-07",
"1988-12-03",
"1988-11-30",
"1988-11-26",
"1988-11-19",
"1988-11-16",
"1988-11-12",
"1988-11-09",
"1988-11-05",
"1988-11-02",
"1988-10-30",
"1988-10-26",
"1988-10-22",
"1988-10-15",
"1988-10-12",
"1988-10-09",
"1988-10-05",
"1988-10-01",
"1988-09-25",
"1988-09-17",
"1988-05-28",
"1988-05-25",
"1988-05-21",
"1988-05-18",
"1988-05-15",
"1988-05-11",
"1988-05-07",
"1988-05-04",
"1988-04-30",
"1988-04-24",
"1988-04-20",
"1988-04-16",
"1988-04-13",
"1988-04-09",
"1988-04-06",
"1988-04-02",
"1988-03-30",
"1988-03-26",
"1988-03-23",
"1988-03-19",
"1988-03-12",
"1988-03-09",
"1988-03-06",
"1988-03-02",
"1988-02-27",
"1988-02-24",
"1988-02-19",
"1988-02-10",
"1988-02-06",
"1988-02-03",
"1988-01-30",
"1988-01-27",
"1988-01-24",
"1988-01-20",
"1988-01-16",
"1988-01-13",
"1988-01-10",
"1988-01-01",
"1987-12-30",
"1987-12-23",
"1987-12-19",
"1987-12-16",
"1987-12-13",
"1987-12-09",
"1987-12-05",
"1987-12-02",
"1987-11-28",
"1987-11-25",
"1987-11-22",
"1987-11-14",
"1987-11-11",
"1987-11-07",
"1987-11-04",
"1987-10-28",
"1987-10-24",
"1987-10-21",
"1987-10-17",
"1987-10-14",
"1987-10-10",
"1987-10-04",
"1987-09-30",
"1987-09-26",
"1987-09-23",
"1987-09-19",
"1987-05-30",
"1987-05-24",
"1987-05-20",
"1987-05-16",
"1987-05-13",
"1987-05-10",
"1987-05-06",
"1987-05-02",
"1987-04-29",
"1987-04-26",
"1987-04-20",
"1987-04-18",
"1987-04-15",
"1987-04-11",
"1987-04-08",
"1987-04-01",
"1987-03-28",
"1987-03-25",
"1987-03-21",
"1987-03-18",
"1987-03-14",
"1987-03-11",
"1987-03-07",
"1987-03-04",
"1987-03-01",
"1987-02-25",
"1987-02-21",
"1987-02-18",
"1987-02-15",
"1987-02-11",
"1987-02-07",
"1987-02-04",
"1987-01-31",
"1987-01-21",
"1987-01-18",
"1987-01-14",
"1987-01-10",
"1987-01-07",
"1987-01-03",
"1987-01-01",
"1986-12-27",
"1986-12-20",
"1986-12-17",
"1986-12-14",
"1986-12-13",
"1986-12-10",
"1986-12-03",
"1986-11-29",
"1986-11-26",
"1986-11-22",
"1986-11-19",
"1986-11-15",
"1986-11-09",
"1986-11-05",
"1986-11-01",
"1986-10-29",
"1986-10-26",
"1986-10-22",
"1986-10-18",
"1986-10-11",
"1986-10-08",
"1986-10-04",
"1986-10-01",
"1986-09-27",
"1986-09-24",
"1986-09-20",
"1986-05-31",
"1986-05-28",
"1986-05-24",
"1986-05-21",
"1986-05-18",
"1986-05-10",
"1986-05-07",
"1986-05-04",
"1986-04-30",
"1986-04-26",
"1986-04-23",
"1986-04-19",
"1986-04-16",
"1986-04-12",
"1986-04-09",
"1986-03-31",
"1986-03-29",
"1986-03-22",
"1986-03-19",
"1986-03-16",
"1986-03-15",
"1986-03-08",
"1986-03-05",
"1986-03-01",
"1986-02-26",
"1986-02-23",
"1986-02-19",
"1986-02-15",
"1986-02-11",
"1986-02-01",
"1986-01-29",
"1986-01-25",
"1986-01-22",
"1986-01-19",
"1986-01-15",
"1986-01-11",
"1986-01-08",
"1986-01-04",
"1986-01-01",
"1985-12-28",
"1985-12-21",
"1985-12-18",
"1985-12-15",
"1985-12-11",
"1985-12-07",
"1985-12-04",
"1985-11-30",
"1985-11-27",
"1985-11-23",
"1985-11-20",
"1985-11-16",
"1985-11-13",
"1985-11-09",
"1985-11-06",
"1985-11-02",
"1985-10-26",
"1985-10-23",
"1985-10-19",
"1985-10-16",
"1985-10-12",
"1985-10-09",
"1985-10-05",
"1985-10-02",
"1985-09-28",
"1985-09-25",
"1985-09-21",
"1985-05-25",
"1985-05-18",
"1985-05-15",
"1985-05-11",
"1985-05-08",
"1985-05-04",
"1985-05-01",
"1985-04-27",
"1985-04-24",
"1985-04-21",
"1985-04-17",
"1985-04-13",
"1985-04-08",
"1985-04-06",
"1985-04-03",
"1985-03-30",
"1985-03-27",
"1985-03-23",
"1985-03-20",
"1985-03-16",
"1985-03-10",
"1985-03-09",
"1985-03-06",
"1985-03-02",
"1985-02-27",
"1985-02-22",
"1985-02-13",
"1985-02-10",
"1985-02-06",
"1985-02-02",
"1985-01-30",
"1985-01-26",
"1985-01-23",
"1985-01-19",
"1985-01-16",
"1985-01-13",
"1985-01-09",
"1985-01-05",
"1985-01-01",
"1984-12-29",
"1984-12-22",
"1984-12-19",
"1984-12-16",
"1984-12-12",
"1984-12-08",
"1984-12-05",
"1984-12-01",
"1984-11-24",
"1984-11-21",
"1984-11-17",
"1984-11-11",
"1984-11-07",
"1984-11-03",
"1984-10-31",
"1984-10-27",
"1984-10-20",
"1984-10-17",
"1984-10-13",
"1984-10-10",
"1984-10-06",
"1984-09-29",
"1984-09-26",
"1984-09-22",
"1984-09-19",
"1984-09-15",
"1984-05-26",
"1984-05-23",
"1984-05-19",
"1984-05-13",
"1984-05-09",
"1984-05-05",
"1984-05-02",
"1984-04-28",
"1984-04-23",
"1984-04-21",
"1984-04-18",
"1984-04-14",
"1984-04-11",
"1984-04-07",
"1984-03-31",
"1984-03-28",
"1984-03-24",
"1984-03-21",
"1984-03-17",
"1984-03-14",
"1984-03-10",
"1984-03-04",
"1984-03-03",
"1984-02-25",
"1984-02-22",
"1984-02-18",
"1984-02-15",
"1984-02-11",
"1984-02-08",
"1984-02-04",
"1984-01-25",
"1984-01-22",
"1984-01-18",
"1984-01-07",
"1984-01-04",
"1984-01-02",
"1983-12-31",
"1983-12-28",
"1983-12-21",
"1983-12-17",
"1983-12-14",
"1983-12-10",
"1983-12-04",
"1983-12-03",
"1983-11-30",
"1983-11-26",
"1983-11-23",
"1983-11-20",
"1983-11-16",
"1983-11-12",
"1983-11-06",
"1983-11-05",
"1983-11-02",
"1983-10-29",
"1983-10-26",
"1983-10-22",
"1983-10-19",
"1983-10-15",
"1983-10-08",
"1983-10-05",
"1983-10-01",
"1983-09-28",
"1983-09-24",
"1983-09-20",
"1983-09-17",
"1983-05-28",
"1983-05-25",
"1983-05-21",
"1983-05-14",
"1983-05-11",
"1983-05-07",
"1983-05-04",
"1983-04-30",
"1983-04-24",
"1983-04-23",
"1983-04-20",
"1983-04-16",
"1983-04-13",
"1983-04-09",
"1983-04-04",
"1983-04-02",
"1983-03-30",
"1983-03-26",
"1983-03-23",
"1983-03-19",
"1983-03-09",
"1983-03-06",
"1983-03-05",
"1983-03-02",
"1983-02-26",
"1983-02-23",
"1983-02-19",
"1983-02-15",
"1983-02-05",
"1983-02-02",
"1983-01-29",
"1983-01-26",
"1983-01-23",
"1983-01-19",
"1983-01-15",
"1983-01-08",
"1983-01-05",
"1983-01-01",
"1982-12-29",
"1982-12-18",
"1982-12-15",
"1982-12-11",
"1982-12-08",
"1982-12-04",
"1982-11-27",
"1982-11-24",
"1982-11-21",
"1982-11-17",
"1982-11-13",
"1982-11-06",
"1982-11-03",
"1982-10-30",
"1982-10-27",
"1982-10-23",
"1982-10-20",
"1982-10-16",
"1982-10-13",
"1982-10-09",
"1982-10-02",
"1982-09-29",
"1982-09-25",
"1982-09-22",
"1982-09-18",
"1982-05-22",
"1982-05-19",
"1982-05-15",
"1982-05-12",
"1982-05-09",
"1982-05-01",
"1982-04-28",
"1982-04-24",
"1982-04-21",
"1982-04-17",
"1982-04-12",
"1982-04-10",
"1982-04-07",
"1982-04-03",
"1982-03-31",
"1982-03-27",
"1982-03-20",
"1982-03-17",
"1982-03-13",
"1982-03-10",
"1982-03-06",
"1982-02-28",
"1982-02-27",
"1982-02-24",
"1982-02-20",
"1982-02-17",
"1982-02-13",
"1982-02-10",
"1982-02-06",
"1982-01-30",
"1982-01-27",
"1982-01-16",
"1982-01-13",
"1982-01-09",
"1982-01-06",
"1982-01-03",
"1982-01-01",
"1981-12-23",
"1981-12-19",
"1981-12-12",
"1981-12-09",
"1981-12-05",
"1981-12-02",
"1981-11-28",
"1981-11-25",
"1981-11-21",
"1981-11-18",
"1981-11-15",
"1981-11-07",
"1981-11-04",
"1981-10-31",
"1981-10-28",
"1981-10-24",
"1981-10-21",
"1981-10-17",
"1981-10-10",
"1981-10-07",
"1981-10-03",
"1981-09-30",
"1981-09-26",
"1981-09-19",
"1981-05-30",
"1981-05-23",
"1981-05-20",
"1981-05-16",
"1981-05-13",
"1981-05-10",
"1981-05-02",
"1981-04-29",
"1981-04-25",
"1981-04-20",
"1981-04-18",
"1981-04-15",
"1981-04-11",
"1981-04-08",
"1981-04-04",
"1981-03-28",
"1981-03-25",
"1981-03-21",
"1981-03-18",
"1981-03-14",
"1981-03-07",
"1981-03-04",
"1981-02-28",
"1981-02-25",
"1981-02-21",
"1981-02-18",
"1981-02-14",
"1981-02-11",
"1981-02-07",
"1981-01-28",
"1981-01-25",
"1981-01-24",
"1981-01-21",
"1981-01-17",
"1981-01-14",
"1981-01-10",
"1981-01-07",
"1981-01-03",
"1981-01-01",
"1980-12-28",
"1980-12-23",
"1980-12-20",
"1980-12-17",
"1980-12-13",
"1980-12-06",
"1980-12-03",
"1980-11-29",
"1980-11-22",
"1980-11-19",
"1980-11-16",
"1980-11-12",
"1980-11-08",
"1980-11-01",
"1980-10-29",
"1980-10-25",
"1980-10-22",
"1980-10-15",
"1980-10-11",
"1980-10-04",
"1980-10-01",
"1980-09-27",
"1980-09-21",
"1980-05-31",
"1980-05-28",
"1980-05-24",
"1980-05-21",
"1980-05-18",
"1980-05-10",
"1980-05-07",
"1980-05-03",
"1980-04-30",
"1980-04-27",
"1980-04-21",
"1980-04-19",
"1980-04-16",
"1980-04-12",
"1980-04-09",
"1980-03-26",
"1980-03-22",
"1980-03-19",
"1980-03-15",
"1980-03-09",
"1980-03-08",
"1980-03-05",
"1980-03-01",
"1980-02-27",
"1980-02-23",
"1980-02-19",
"1980-02-09",
"1980-02-06",
"1980-02-02",
"1980-01-30",
"1980-01-26",
"1980-01-20",
"1980-01-19",
"1980-01-16",
"1980-01-12",
"1980-01-09",
"1980-01-05",
"1980-01-01",
"1979-12-29",
"1979-12-22",
"1979-12-15",
"1979-12-12",
"1979-12-09",
"1979-12-05",
"1979-12-01",
"1979-11-24",
"1979-11-21",
"1979-11-17",
"1979-11-14",
"1979-11-10",
"1979-11-04",
"1979-10-31",
"1979-10-27",
"1979-10-24",
"1979-10-20",
"1979-10-13",
"1979-10-10",
"1979-10-06",
"1979-10-03",
"1979-09-29",
"1979-09-22"
]
 
driver = webdriver.Chrome()

wait = WebDriverWait(driver, 10)

def check_exists_by_xpath(xpath):
  try:
      driver.find_element_by_xpath(xpath)
  except NoSuchElementException:
      return False
  return True

"""
Initialize variables: 

Data collected per entry: 

Racing Date, Racing Number, WIN, PLACE, PLAC, PLACE, QUINELLA, QUINELLA PLACE, QUINELLA PLACE, QUINELLA PLACE, 3 Pick 1, (COMPOSITE WIN) A1,  (COMPOSITE WIN) A2,  (COMPOSITE WIN) A3, TIERCE,  TRIO,  FIRST 4, QUARTET, DOUBLE, TREBLE, DOUBLE TRIO, SIX UP, JOCKEY CHALLENGE

"""

race_name_xpath = "/html/body/div/div[4]/table/thead/tr/td[1]"



race_table_xpath = string.Template('''/html/body/div/div[6]/table/tbody/tr[$row]/td[$col]''')

same_day_race_link_xpaths = "//div[2]/table/tbody/tr/td/a"
table_row_xpath = "//div[6]/table/tbody/tr"

count = 0
race_name = ""


# Begin grabbing data
for meet in dates:
  print("Scraping: " + meet)
  race_entry = []
  internalRaceCount = 1
  count += 1
  if os.path.isfile('Races_Dividend_' + str(meet) + '.txt'):
    continue
  else:
    driver.get(BASE_URL + meet)
    driver.implicitly_wait(20)
    same_day_selel = driver.find_elements_by_xpath(same_day_race_link_xpaths)[:-1]
    same_day_links = [x.get_attribute("href") for x in same_day_selel]  
    
    # Get first race - x columns y rows + race name, going, track type
    #tempTableEl = wait.until(EC.presence_of_all_elements_located((By.XPATH, table_row_xpath)))
    #table_rows = tempTableEl

    if not (check_exists_by_xpath(table_row_xpath)):
      continue
    else:
      tempTableEl = wait.until(EC.presence_of_all_elements_located((By.XPATH, table_row_xpath)))
      table_rows = tempTableEl

    if (check_exists_by_xpath(race_name_xpath)):
      tempEl = wait.until(EC.presence_of_element_located((By.XPATH, race_name_xpath)))
      race_name = (tempEl.text)




      
      
    for row in table_rows:
      rowEntry = []

      rowEntry.append(meet)

      rowEntry.append(race_name)

  
      cols = row.find_elements_by_tag_name('td')
      for col in cols:
        rowEntry.append(col.text)
      race_entry.append(rowEntry)
    
    # Get other races on same meet
    for same_day_link in same_day_links:
      print("Scraping " + same_day_link)
      internalRaceCount += 1
      driver.get(same_day_link)
      driver.implicitly_wait(10)

      # Scrape 2nd - n
      if (check_exists_by_xpath(race_name_xpath)):
        tempEl = wait.until(EC.presence_of_element_located((By.XPATH, race_name_xpath)))
        race_name = (tempEl.text)

      
      table_rows = driver.find_elements_by_xpath(table_row_xpath)

      for row in table_rows:
        rowEntry = []

        rowEntry.append(meet)
        
        rowEntry.append(race_name)

        
        cols = row.find_elements_by_tag_name('td')
        for col in cols:
          rowEntry.append(col.text)
        race_entry.append(rowEntry)
        
    # Save file as csv
    df = pd.DataFrame(race_entry)
    print(df.head())
    csv_data = df.to_csv("./Races_Dividend_" + str(meet) + ".txt", index=False)
    print("Saved " + str(meet))

driver.quit()
